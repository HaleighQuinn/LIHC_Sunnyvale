coord_flip() +
theme(
legend.position = "bottom",
legend.direction = "vertical"
) + scale_x_discrete(label = function(x) stringr::str_trunc(x, 12))
#Filled Plot:
sc_poverty_race %>%
group_by(income, race) %>%
summarize(estimate = sum(estimate)) %>%
ggplot() +
geom_bar(
aes(
x = income %>% factor(),
y = estimate,
fill = race
),
stat = "identity",
position = "fill"
) +
labs(
x = "Income level in relation to poverty level",
y = "Race of Respondents",
title = "Poverty Status in the Past 12 Months",
fill = "Race "
) +
coord_flip() +
theme(
legend.position = "bottom",
legend.direction = "vertical"
) + scale_x_discrete(label = function(x) stringr::str_trunc(x, 12))
#Filled Plot:
sc_poverty_race %>%
group_by(income, race) %>%
summarize(estimate = sum(estimate)) %>%
ggplot() +
geom_bar(
aes(
x = income %>% factor(),
y = estimate,
fill = race
),
stat = "identity",
position = "fill"
) +
labs(
x = "Income level in relation to poverty level",
y = "Race of Respondents",
title = "Poverty Status in the Past 12 Months",
fill = "Race "
) +
coord_flip() +
theme(
legend.position = "bottom",
legend.direction = "vertical"
)
sc_poverty_youngadult <-
sc_poverty_race %>%
mutate(
youngadult =
ifelse(
age %in% c(
"25 to 34 years",
"35 to 44 years"
),
estimate,
NA
)
) %>%
group_by(race) %>%
summarize(
youngadult = sum(youngadult, na.rm = T),
total_pop = sum(estimate, na.rm = T)
) %>%
mutate(
percent_youngadult = youngadult/total_pop*100
) %>%
filter(!is.na(percent_youngadult))
View(sc_poverty_youngadult)
# Pie Chart: Percentage
sc_poverty_youngadult <-
sc_poverty_race %>%
mutate(
youngadult =
ifelse(
age %in% c(
"25 to 34 years",
"35 to 44 years"
),
estimate,
NA
)
) %>%
group_by(race, income) %>%
summarize(
youngadult = sum(youngadult, na.rm = T),
total_pop = sum(estimate, na.rm = T)
) %>%
mutate(
percent_youngadult = youngadult/total_pop*100
) %>%
filter(!is.na(percent_youngadult))
# Pie Chart: Percentage
sc_poverty_youngadult <-
sc_poverty_race %>%
mutate(
youngadult =
ifelse(
age %in% c(
"25 to 34 years",
"35 to 44 years"
),
estimate,
NA
)
) %>%
group_by(race, income) %>%
summarize(
youngadult = sum(youngadult, na.rm = T),
total_pop = sum(estimate, na.rm = T)
) %>%
mutate(
percent_youngadult = youngadult/total_pop*100
) %>%
filter(!is.na(percent_youngadult)) %>%
filter(!is.na(income))
sc_poverty_race <-
1:7 %>%
map_dfr(function(x){
getCensus(
name = "acs/acs5",
vintage = 2019,
region = "county:085",
regionin = "state:06",
vars = paste0("group(B17001",LETTERS[x],")")
) %>%
select(!c(GEO_ID,state,NAME) & !ends_with(c("EA","MA","M"))) %>%
pivot_longer(
ends_with("E"),
names_to = "variable",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_5yr %>%
select(name, label),
by = c("variable" = "name")
) %>%
select(-variable) %>%
separate(
label,
into = c(NA, NA, "income", "sex", "age"),
sep = "!!"
) %>% filter(!is.na("age")) %>%
filter(!is.an("income")) %>%
mutate(race = census_race_labels[x])
})
sc_poverty_race <-
1:7 %>%
map_dfr(function(x){
getCensus(
name = "acs/acs5",
vintage = 2019,
region = "county:085",
regionin = "state:06",
vars = paste0("group(B17001",LETTERS[x],")")
) %>%
select(!c(GEO_ID,state,NAME) & !ends_with(c("EA","MA","M"))) %>%
pivot_longer(
ends_with("E"),
names_to = "variable",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_5yr %>%
select(name, label),
by = c("variable" = "name")
) %>%
select(-variable) %>%
separate(
label,
into = c(NA, NA, "income", "sex", "age"),
sep = "!!"
) %>% filter(!is.na("age")) %>%
filter(!is.na("income")) %>%
mutate(race = census_race_labels[x])
})
sc_poverty_race <-
1:7 %>%
map_dfr(function(x){
getCensus(
name = "acs/acs5",
vintage = 2019,
region = "county:085",
regionin = "state:06",
vars = paste0("group(B17001",LETTERS[x],")")
) %>%
select(!c(GEO_ID,state,NAME) & !ends_with(c("EA","MA","M"))) %>%
pivot_longer(
ends_with("E"),
names_to = "variable",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_5yr %>%
select(name, label),
by = c("variable" = "name")
) %>%
select(-variable) %>%
separate(
label,
into = c(NA, NA, "income", "sex", "age"),
sep = "!!"
) %>% filter(!is.na(age)) %>%
filter(!is.na(income)) %>%
mutate(race = census_race_labels[x])
})
# Filled Plot:
sc_poverty_race %>%
group_by(income, race) %>%
summarize(estimate = sum(estimate)) %>%
ggplot() +
geom_bar(
aes(
x = income %>% factor(),
y = estimate,
fill = race
),
stat = "identity",
position = "fill"
) +
labs(
x = "Income level in relation to poverty level",
y = "Race of Respondents",
title = "Poverty Status in the Past 12 Months",
fill = "Race "
) +
coord_flip() +
theme(
legend.position = "bottom",
legend.direction = "vertical"
)
colors <- c('rgb(102,102,255)', 'rgb(178,102,255)', 'rgb(255,102,178)', 'rgb(102,178,255)', 'rgb(255,178,102)', 'rgb(255,102,102)')
poverty_chart <-
sc_poverty_youngadult %>%
filter(income %in% c("Income in the past 12 months at or above poverty level:", "Income in the past 12 months below poverty level:")) %>%
group_by(income, race) %>%
summarize(estimate = sum(estimate))
youngadult_pal <- colorNumeric(
palette = "Blues",
domain =
sc_elderly$percent_youngadult
)
leaflet() %>%
addTiles() %>%
addPolygons(
data =
sc_poverty_youngadult %>%
fillColor = ~youngadult_pal (percent_youngadult),
sc_poverty_youngadult %>%
group_by(income, race) %>%
summarize(estimate = sum(estimate)) %>%
ggplot() +
geom_bar(
aes(
x = income %>% factor(),
y = percent_youngadult,
fill = race
),
stat = "identity",
position = "fill"
) +
labs(
x = "Income level in relation to poverty level",
y = "Percent of Adults age 24-34 in poverty",
title = "Poverty Status in the Past 12 Months",
fill = "Race "
) +
coord_flip() +
theme(
legend.position = "bottom",
legend.direction = "vertical"
)
sc_poverty_youngadult %>%
group_by(income, race) %>%
summarize(percent_youngadult = sum(percent_youngadult)) %>%
ggplot() +
geom_bar(
aes(
x = income %>% factor(),
y = percent_youngadult,
fill = race
),
stat = "identity",
position = "fill"
) +
labs(
x = "Income level in relation to poverty level",
y = "Percent of Adults age 24-34 in poverty",
title = "Poverty Status in the Past 12 Months",
fill = "Race "
) +
coord_flip() +
theme(
legend.position = "bottom",
legend.direction = "vertical"
)
sc_poverty_youngadult %>%
group_by(income, race) %>%
summarize(percent_youngadult = sum(percent_youngadult)) %>%
ggplot() +
geom_bar(
aes(
x = income %>% factor(),
y = percent_youngadult,
fill = race
),
stat = "identity",
position = "fill"
) +
labs(
x = "Income level in relation to poverty level",
y = "Percent of Adults age 24-34 in poverty",
title = "Poverty Status in the Past 12 Months",
fill = "Race "
) +
coord_flip() +
theme(
legend.position = "bottom",
legend.direction = "vertical"
)
# Filled Plot:
sc_poverty_race %>%
group_by(income, race) %>%
summarize(estimate = sum(estimate)) %>%
ggplot() +
geom_bar(
aes(
x = income %>% factor(),
y = estimate,
fill = race
),
stat = "identity",
position = "stack"
) +
labs(
x = "Income level in relation to poverty level",
y = "Race of Respondents",
title = "Poverty Status in the Past 12 Months",
fill = "Race "
) +
coord_flip() +
theme(
legend.position = "bottom",
legend.direction = "vertical"
)
# Filled Plot:
sc_poverty_race %>%
group_by(income, race) %>%
summarize(estimate = sum(estimate)) %>%
ggplot() +
geom_bar(
aes(
x = income %>% factor(),
y = estimate,
fill = race
),
stat = "identity",
position = "fill"
) +
labs(
x = "Income level in relation to poverty level",
y = "Race of Respondents",
title = "Poverty Status in the Past 12 Months",
fill = "Race "
) +
coord_flip() +
theme(
legend.position = "bottom",
legend.direction = "vertical"
)
sc_poverty_youngadult %>%
group_by(income, race) %>%
summarize(percent_youngadult = sum(percent_youngadult)) %>%
ggplot() +
geom_bar(
aes(
x = income %>% factor(),
y = percent_youngadult,
fill = race
),
stat = "identity",
position = "fill"
) +
labs(
x = "Income level in relation to poverty level",
y = "Percent of Adults age 24-34 in poverty",
title = "Poverty Status in the Past 12 Months",
fill = "Race "
) +
coord_flip() +
theme(
legend.position = "bottom",
legend.direction = "vertical"
)
youngadult_pov_chart <-
sc_poverty_youngadult%>%
filter(income %in% "Income in the past 12 months below poverty level:") %>%
group_by(income, race) %>%
summarize(percent_youngadult = sum(percent_youngadult))
View(youngadult_pov_chart)
youngadult_pov_fig <-
plot_ly(youngadult_pov_chart, labels = ~race, values = ~percent_youngadult,
type = 'pie',
textposition = 'outside',
textinfo = 'percent',
outsidetextfont = list(color = '#404040'),
hoverinfo = 'text',
text = ~paste(estimate, 'respondents'),
marker = list(colors = colors,
line = list(color = '#FFFFFF', width = 0.5)),
showlegend = TRUE)
youngadult_pov_fig <-
youngadult_pov_fig %>%
layout(title = "% Respondents 24-34 below the poverty line in the past 12 months",
xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE, cex.lab = 0.5),
yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))
library(plotly)
youngadult_pov_fig <-
plot_ly(youngadult_pov_chart, labels = ~race, values = ~percent_youngadult,
type = 'pie',
textposition = 'outside',
textinfo = 'percent',
outsidetextfont = list(color = '#404040'),
hoverinfo = 'text',
text = ~paste(estimate, 'respondents'),
marker = list(colors = colors,
line = list(color = '#FFFFFF', width = 0.5)),
showlegend = TRUE)
youngadult_pov_fig <-
youngadult_pov_fig %>%
layout(title = "% Respondents 24-34 below the poverty line in the past 12 months",
xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE, cex.lab = 0.5),
yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))
youngadult_pov_fig
youngadult_pov_fig <-
plot_ly(youngadult_pov_chart, labels = ~race, values = ~percent_youngadult,
type = 'pie',
textposition = 'outside',
textinfo = 'percent',
outsidetextfont = list(color = '#404040'),
hoverinfo = 'text',
text = ~paste(percent_youngadult, 'respondents'),
marker = list(colors = colors,
line = list(color = '#FFFFFF', width = 0.5)),
showlegend = TRUE)
youngadult_pov_fig <-
youngadult_pov_fig %>%
layout(title = "% Respondents 24-34 below the poverty line in the past 12 months",
xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE, cex.lab = 0.5),
yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))
youngadult_pov_fig
# Chart: Percentage of Elderly in Poverty SC County
sc_poverty_elderly <-
sc_poverty_race %>%
mutate(
elderly =
ifelse(
age %in% c(
"65 to 74 years",
"75 years and older"
),
estimate,
NA
)
) %>%
group_by(race, income) %>%
summarize(
elderly = sum(elderly, na.rm = T),
total_pop = sum(estimate, na.rm = T)
) %>%
mutate(
percent_elderly = elderly/total_pop*100
) %>%
filter(!is.na(percent_elderly)) %>%
filter(!is.na(income))
View(sc_poverty_elderly)
elderly_pov_chart <-
sc_poverty_elderly%>%
filter(income %in% "Income in the past 12 months below poverty level:") %>%
group_by(income, race) %>%
summarize(percent_elderly = sum(percent_elderly))
elderly_pov_fig <-
plot_ly(elderly_pov_chart, labels = ~race, values = ~percent_elderly,
type = 'pie',
textposition = 'outside',
textinfo = 'percent',
outsidetextfont = list(color = '#404040'),
hoverinfo = 'text',
text = ~paste(percent_elderly, 'respondents'),
marker = list(colors = colors,
line = list(color = '#FFFFFF', width = 0.5)),
showlegend = TRUE)
elderly_pov_fig <-
elderly_pov_fig %>%
layout(title = "% Respondents 24-34 below the poverty line in the past 12 months",
xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE, cex.lab = 0.5),
yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))
elderly_pov_fig <-
elderly_pov_fig %>%
layout(title = "% Respondents above 65 below the poverty line in the past 12 months",
xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE, cex.lab = 0.5),
yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))
elderly_pov_fig
